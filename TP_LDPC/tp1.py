import pandas as pd 
import random as rd
import matplotlib.pyplot as plt
import numpy as np
import scipy.stats

H1 = pd.read_csv("H1.csv",header=None)
H2 = pd.read_csv("H2.csv",header=None)
#print(H1)
def question1(H1,H2):
    dv1 = H1.sum(0)
    dc1 = H1.sum(1)

    dv2 = H2.sum(0)
    dc2 = H2.sum(1) 


    if len(set(dv1)) == 1 and len(set(dc1)) == 1:
        dv = dv1[0]
        dc = dc1[0]
        rate = 1 - dv/dc
        print('-'*60)
        print("H1 is regular : dv = ",dv," dc = ",dc, " Rate = ", rate)
        print('-'*60)

    if len(set(dv2)) == 1 and len(set(dc2)) == 1:
        dv = dv2[0]
        dc = dc2[0]
        rate = 1 - dv/dc
        print("H2 is regular : dv = ",dv," dc = ",dc, " Rate = ", rate)
        print('-'*60)


    #sparsity

    h1sparsity = dv1.sum(0)/H1.size
    h2sparsity = dv2.sum(0)/H2.size
    print("H1 sparsity = ", h1sparsity," H2 sparsity = ",h2sparsity)
    print(H1.shape)

def bsc(x,p) :
    x2 = []
    for i in x.values.tolist()[0] :
        r = rd.random()
        if r < p:
            x2.append((i+1) % 2)
        else:
            x2.append(i)
    return x2



def paritycheck(H,x) :
    Ht = H.transpose()
    return x.dot(Ht) % 2


x1 = pd.DataFrame([0 for _ in range(H1.shape[1])])
x1 = x1.transpose()
x2 = pd.DataFrame([0 for _ in range(H2.shape[1])])
x2 = x2.transpose()
#print(bsc(x,0.1))
#print(paritycheck(H1,x))

def gallagerA(y,H,L) :
    m0 = y
    mv = m0.copy()



    dv = H.sum(0)[0]
    dc = H.sum(1)[0]
    M,N = H.shape[0], H.shape[1]
    #print(M,N)
    Vcn = pd.DataFrame([[[0,0] for j in range(M)] for i in range(dc)])
    for j in range(M) :
        Ht = H.transpose()
        
        index = np.argwhere(Ht[j].values.tolist())
        for i in range(dc):
            Vcn[j][i] = [index[i][0],None]
    #print(Vcn)
    Vvn = pd.DataFrame([[[0,0] for j in range(N)] for i in range(dv)])
    for j in range(N):
        index = np.argwhere(H[j].values.tolist())
        for i in range(dv):
            Vvn[j][i] = [index[i][0],None]
    #print(Vvn)


    for k in range(L) :
        for m in range(M) :
            for i in range(dc):
                sum = 0
                for ii in range(dc):
                    if Vcn[m][i][0] != Vcn[m][ii][0] :
                        sum = (sum + mv[Vcn[m][ii][0]]) % 2   
                Vcn[m][i][1] =  sum
        #print(Vcn)

        x = [None for _ in range(N)]
        for n in range(N) :
            for j in range(dv) :
                index = Vvn[n][j][0]  
                for ii in range(dc):
                    if Vcn[index][ii][0] == n:
                        Vvn[n][j][1] = Vcn[index][ii][1]
            i = 0
            for jj in range(dv):
                if Vvn[n][jj][1] != m0[n]:
                    i += 1
            if i >= dv-1:
                mv[n] = (m0[n] + 1)%2
            else:
                mv[n] = m0[n]
        #print(Vvn)
            sum = 0
            for j in range(dv):
                sum += Vvn[n][j][1]
            if m0[n] + sum > np.ceil((dv+1)/2) :
                #if k==L-1 : print("m0[i]=", m0[i], " sum=", sum, " m0[i]+sum=", m0[i]+sum, " >= np.ceil((dv+1)/2)=", np.ceil((dv+1)/2))
                x[n] = 1
            else:
                #if k==L-1 : print("m0[i]=", m0[i], " sum=", sum, " m0[i]+sum=", m0[i]+sum, "<= np.ceil((dv+1)/2)=", np.ceil((dv+1)/2))
                x[n] = 0
        
        check = paritycheck(H,pd.DataFrame(x).transpose())
        if check.transpose()[0].sum() == 0 :
            #print("early stop at k=", k, "check.sum=", check.transpose()[0].sum(),"x.sum=", pd.DataFrame(x)[0].sum())
            #if k!=0 : 
            print(k)
            return [x,True]
        # print("check=", check.transpose()[0])

    #print("Vvn=", Vvn, "Vcn=", Vcn)
    #print("reached end of iteration count.")
    print(k)
    return [x,False]
"""                
y1 = bsc(x1,0.1)
print("y1=",y1)
y2 = bsc(x2,0.015)
print("gallager1=" , gallagerA(y1,H1,500))
print(60*"-")
print("y2=",y2)
print("gallager2=", gallagerA(y2,H2,100))
"""

def testGallager(range_p,range_k,range_tests,H) :
    y = pd.DataFrame([0 for _ in range(H.shape[1])]).transpose()
    data = [[[0,0] for _ in range_p] for _ in range_k]
    print(data)
    pp = 0
    for p in range_p:
        kk = 0
        print("tests: ", range_tests[pp])
        for k in range_k:
            decoded = 0
            total = 0
            ber = []
            for _ in range(round(range_tests[pp])):
                yy = bsc(y,p)
                total += 1
                gallager = gallagerA(yy,H,k)
                ber.append(sum(gallager[0])/len(gallager[0]))
                #print(sum(gallager[0]))
                if gallager[1]== True:
                    decoded += 1
            data[kk][pp] = [((total-decoded)/total),sum(ber)/len(ber)]
            
            print("[k:",k,",p:",p,"] -> FER = ",((total-decoded)/total), " BER = ",sum(ber)/len(ber))
            kk += 1
        pp += 1
    return data

range_p = np.arange(0.010,0.4,0.004)
#print(range_p)
ap=0.05
poff=0.015
pfinal=0.1
Kp=(poff-pfinal)/(1-np.exp(ap*100))
Cp=(poff*np.exp(ap*100) -pfinal)/(poff-pfinal)

#range_p_exp = [ (0.1/(np.exp(a*100)-1))*(np.exp(a*x)-1) for x in range(101)]
#range_p = [Kp*(np.exp(ap*x)- Cp) for x in range(101)]

at=0.03
toff=450
tfinal=50
Kt=(tfinal-toff)/(1-np.exp(at*100))
Ct=(tfinal*np.exp(at*100) -toff)/(tfinal-toff)

range_t_exp = [Kt*(np.exp(at*(100-x))- Ct) for x in range(101)]
#print(range_p_exp)
#plt.plot(range(101),range_p_exp)
#plt.show()
#plt.plot(range(101),range_t_exp)
#plt.show()

range_k = [30]
#data = testGallager(range_p,range_k,range_t_exp,H1)
#data=[[[0.12, 0.008968253968253969], [0.06382978723404255, 0.006247889226612631], [0.25, 0.02371933621933622], [0.17073170731707318, 0.020470383275261322], [0.15789473684210525, 0.015611946532999165], [0.05555555555555555, 0.005125661375661376], [0.17647058823529413, 0.019257703081232494], [0.15625, 0.012958829365079364], [0.13333333333333333, 0.009523809523809525], [0.07142857142857142, 0.008503401360544218], [0.11538461538461539, 0.0016788766788766788], [0.16, 0.006507936507936508], [0.13043478260869565, 0.012681159420289854], [0.045454545454545456, 0.006944444444444445], [0.23809523809523808, 0.0104875283446712], [0.1, 0.00744047619047619], [0.05263157894736842, 0.006683375104427736], [0.16666666666666666, 0.016644620811287477], [0.11764705882352941, 0.009220354808590103], [0.25, 0.019097222222222227], [0.2, 0.024074074074074074], [0.14285714285714285, 0.012329931972789115], [0.2857142857142857, 0.022817460317460316], [0.15384615384615385, 0.012667887667887668], [0.0, 0.0], [0.16666666666666666, 0.0013227513227513227], [0.09090909090909091, 0.01424963924963925], [0.09090909090909091, 0.003066378066378066], [0.2, 0.025595238095238095], [0.3, 0.03948412698412699], [0.2, 0.02678571428571429], [0.1111111111111111, 0.0004409171075837742], [0.1111111111111111, 0.01895943562610229], [0.0, 0.0], [0.125, 0.002232142857142857], [0.0, 0.0], [0.25, 0.019593253968253968], [0.125, 0.001488095238095238], [0.125, 0.001488095238095238], [0.14285714285714285, 0.021825396825396828], [0.0, 0.0], [0.5714285714285714, 0.07794784580498867], [0.14285714285714285, 0.006519274376417234], [0.2857142857142857, 0.02040816326530612], [0.14285714285714285, 0.021541950113378682], [0.14285714285714285, 0.015873015873015872], [0.3333333333333333, 0.04728835978835979], [0.16666666666666666, 0.02281746031746032], [0.3333333333333333, 0.028108465608465607], [0.5, 0.05886243386243386], [0.3333333333333333, 0.037698412698412696], [0.5, 0.06216931216931217], [0.16666666666666666, 0.0205026455026455], [0.16666666666666666, 0.017526455026455025], [0.16666666666666666, 0.0016534391534391533], [0.6666666666666666, 0.07043650793650792], [0.3333333333333333, 0.04563492063492063], [0.3333333333333333, 0.04464285714285715], [0.8333333333333334, 0.11541005291005291], [0.3333333333333333, 0.05125661375661376], [0.6, 0.028968253968253966], [0.4, 0.05436507936507937], [0.8, 0.08452380952380951], [0.2, 0.02857142857142857], [0.6, 0.0865079365079365], [0.8, 0.11706349206349205], [0.8, 0.1015873015873016], [0.8, 0.10555555555555554], [0.6, 0.08214285714285716], [0.8, 0.11468253968253968], [0.6, 0.07619047619047618], [1.0, 0.14920634920634923], [0.6, 0.05753968253968254], [0.8, 0.11190476190476191], [0.6, 0.08571428571428572], [0.8, 0.11666666666666667], [1.0, 0.14444444444444446], [1.0, 0.1496031746031746], [1.0, 0.14246031746031745], [1.0, 0.13452380952380952], [1.0, 0.1488095238095238], [1.0, 0.13571428571428573], [1.0, 0.15317460317460316], [0.8, 0.11468253968253969], [1.0, 0.15436507936507937], [1.0, 0.1496031746031746], [1.0, 0.15079365079365079], [1.0, 0.14563492063492062], [1.0, 0.14206349206349206], [1.0, 0.15238095238095237], [1.0, 0.15555555555555556], [1.0, 0.14087301587301587], [1.0, 0.14841269841269839], [1.0, 0.14603174603174604], [1.0, 0.15833333333333333], [1.0, 0.1642857142857143], [1.0, 0.15634920634920635], [1.0, 0.15119047619047618], [1.0, 0.15833333333333333], [1.0, 0.16468253968253968], [1.0, 0.1488095238095238]]]
#data=[[[0.08, 0.005238095238095239], [0.09278350515463918, 0.005584192439862541], [0.0851063829787234, 0.004812563323201621], [0.08791208791208792, 0.009462759462759464], [0.12359550561797752, 0.01079008382379169], [0.09302325581395349, 0.01107419712070875], [0.13095238095238096, 0.008125472411186694], [0.09876543209876543, 0.01173329414070155], [0.0759493670886076, 0.00683142455294354], [0.07894736842105263, 0.0068922305764411015], [0.16216216216216217, 0.012333762333762334], [0.1111111111111111, 0.009700176366843033], [0.11428571428571428, 0.007936507936507936], [0.17647058823529413, 0.01397642390289449], [0.13636363636363635, 0.012566137566137565], [0.1875, 0.01999627976190476], [0.11290322580645161, 0.015232974910394265], [0.11666666666666667, 0.012533068783068783], [0.1724137931034483, 0.013546798029556651], [0.17543859649122806, 0.019736842105263157], [0.2, 0.021103896103896104], [0.1509433962264151, 0.016060197663971248], [0.1346153846153846, 0.016369047619047616], [0.16, 0.013015873015873015], [0.24489795918367346, 0.018545513443472626], [0.0851063829787234, 0.007978723404255319], [0.2826086956521739, 0.024499654934437537], [0.18181818181818182, 0.016459235209235208], [0.16279069767441862, 0.016888150609080842], [0.21428571428571427, 0.019794028722600148], [0.24390243902439024, 0.02705187766163376], [0.10256410256410256, 0.00691900691900692], [0.15789473684210525, 0.01331453634085213], [0.13513513513513514, 0.008633633633633633], [0.08333333333333333, 0.011022927689594357], [0.11428571428571428, 0.008390022675736963], [0.20588235294117646, 0.017098506069094306], [0.21212121212121213, 0.027417027417027416], [0.15625, 0.01023065476190476], [0.0967741935483871, 0.013312852022529442], [0.2, 0.02215608465608466], [0.10344827586206896, 0.013957307060755337], [0.14285714285714285, 0.009991496598639456], [0.2857142857142857, 0.02565192743764172], [0.3333333333333333, 0.023001175778953557], [0.19230769230769232, 0.020222832722832724], [0.24, 0.023015873015873014], [0.375, 0.03488756613756614], [0.25, 0.01868386243386243], [0.30434782608695654, 0.02691511387163561], [0.4090909090909091, 0.045364357864357864], [0.4090909090909091, 0.02795815295815296], [0.38095238095238093, 0.043650793650793655], [0.25, 0.032242063492063495], [0.35, 0.039384920634920634], [0.47368421052631576, 0.059314954051796154], [0.42105263157894735, 0.0483500417710944], [0.5, 0.05709876543209877], [0.3888888888888889, 0.04596560846560846], [0.7058823529411765, 0.07878151260504201], [0.4117647058823529, 0.043534080298786186], [0.375, 0.049355158730158735], [0.5, 0.04513888888888888], [0.3333333333333333, 0.0425925925925926], [0.8, 0.08121693121693123], [0.6428571428571429, 0.0824829931972789], [0.7857142857142857, 0.10260770975056689], [0.6923076923076923, 0.0837912087912088], [0.6153846153846154, 0.08592796092796093], [0.8461538461538461, 0.12408424908424909], [0.3333333333333333, 0.04861111111111111], [0.75, 0.10879629629629632], [0.9166666666666666, 0.1306216931216931], [1.0, 0.14177489177489178], [0.9090909090909091, 0.11507936507936507], [0.9090909090909091, 0.1257215007215007], [1.0, 0.1367063492063492], [1.0, 0.14067460317460317], [1.0, 0.1371031746031746], [1.0, 0.14285714285714285], [1.0, 0.14307760141093473], [1.0, 0.14021164021164023], [1.0, 0.1470458553791887], [1.0, 0.1396329365079365], [1.0, 0.140625], [1.0, 0.15947420634920634], [1.0, 0.1505456349206349], [1.0, 0.14484126984126983], [1.0, 0.16043083900226757], [1.0, 0.16043083900226757], [1.0, 0.15334467120181405], [1.0, 0.13605442176870747], [1.0, 0.15178571428571427], [1.0, 0.14914021164021163], [1.0, 0.15476190476190477], [1.0, 0.15773809523809526], [1.0, 0.16567460317460317], [1.0, 0.15674603174603174], [1.0, 0.14007936507936508], [1.0, 0.15952380952380954], [1.0, 0.16031746031746033]]]
#data = [[[0.0, 0.0], [0.0, 0.0], [0.004705882352941176, 0.002], [0.004830917874396135, 0.0008454106280193236], [0.0, 0.0], [0.0025575447570332483, 0.0012787723785166241], [0.02099737532808399, 0.0068241469816272965], [0.005405405405405406, 0.0018918918918918919], [0.011111111111111112, 0.0020833333333333333], [0.002857142857142857, 0.0005714285714285715], [0.005865102639296188, 0.0030791788856304987], [0.02108433734939759, 0.00858433734939759], [0.021671826625386997, 0.005417956656346749], [0.01910828025477707, 0.004936305732484076], [0.032679738562091505, 0.010294117647058822], [0.020202020202020204, 0.006565656565656565], [0.020689655172413793, 0.005862068965517241], [0.031914893617021274, 0.012411347517730497], [0.043795620437956206, 0.01186131386861314], [0.033707865168539325, 0.00898876404494382], [0.05, 0.016538461538461537], [0.05138339920948617, 0.019367588932806323], [0.06072874493927125, 0.019230769230769232], [0.075, 0.02291666666666666], [0.05555555555555555, 0.019230769230769232], [0.07456140350877193, 0.023464912280701758], [0.07207207207207207, 0.01689189189189189], [0.09259259259259259, 0.035416666666666666], [0.0947867298578199, 0.027725118483412324], [0.1073170731707317, 0.029024390243902447], [0.12, 0.029749999999999995], [0.08717948717948718, 0.02487179487179487], [0.12105263157894737, 0.04026315789473684], [0.08108108108108109, 0.025675675675675677], [0.143646408839779, 0.05441988950276243], [0.1534090909090909, 0.042045454545454546], [0.14534883720930233, 0.038081395348837206], [0.14285714285714285, 0.04553571428571429], [0.17073170731707318, 0.06036585365853659], [0.16875, 0.0540625], [0.16025641025641027, 0.044230769230769226], [0.17763157894736842, 0.06052631578947369], [0.1891891891891892, 0.07060810810810811], [0.20689655172413793, 0.06310344827586208], [0.23404255319148937, 0.08156028368794328], [0.16666666666666666, 0.05797101449275364], [0.25925925925925924, 0.0751851851851852], [0.16666666666666666, 0.05984848484848484], [0.23255813953488372, 0.07286821705426355], [0.23809523809523808, 0.08333333333333333], [0.24390243902439024, 0.07886178861788617], [0.325, 0.09125000000000003], [0.2033898305084746, 0.056355932203389816], [0.24347826086956523, 0.0773913043478261], [0.29464285714285715, 0.09955357142857146], [0.2909090909090909, 0.1068181818181818], [0.2523364485981308, 0.08551401869158881], [0.3619047619047619, 0.10714285714285712], [0.3883495145631068, 0.11844660194174758], [0.36633663366336633, 0.12128712871287131], [0.36363636363636365, 0.11565656565656564], [0.3917525773195876, 0.1402061855670103], [0.35789473684210527, 0.10789473684210528], [0.41935483870967744, 0.12258064516129033], [0.3626373626373626, 0.1120879120879121], [0.4157303370786517, 0.1410112359550562], [0.40229885057471265, 0.1235632183908046], [0.49411764705882355, 0.16176470588235295], [0.39285714285714285, 0.11964285714285713], [0.43902439024390244, 0.14390243902439026], [0.4444444444444444, 0.141358024691358], [0.43037974683544306, 0.12721518987341773], [0.46153846153846156, 0.1455128205128205], [0.4868421052631579, 0.15855263157894736], [0.4666666666666667, 0.15266666666666664], [0.5753424657534246, 0.18150684931506852], [0.5416666666666666, 0.17569444444444446], [0.5211267605633803, 0.17676056338028168], [0.5142857142857142, 0.19142857142857142], [0.4117647058823529, 0.1463235294117647], [0.6268656716417911, 0.20522388059701493], [0.5606060606060606, 0.17424242424242425], [0.49230769230769234, 0.1576923076923077], [0.5625, 0.20156250000000006], [0.5238095238095238, 0.1642857142857143], [0.532258064516129, 0.16693548387096774], [0.4918032786885246, 0.1639344262295082], [0.5166666666666667, 0.1683333333333333], [0.7288135593220338, 0.2423728813559322], [0.7413793103448276, 0.20862068965517244], [0.6140350877192983, 0.2140350877192982], [0.6071428571428571, 0.18392857142857144], [0.6964285714285714, 0.23035714285714276], [0.6181818181818182, 0.21090909090909088], [0.7037037037037037, 0.23703703703703702]]]
data = [[[0.0, 0.0], [0.0, 0.0], [0.004705882352941176, 0.002235294117647059], [0.0024154589371980675, 0.0006038647342995169], [0.0024875621890547263, 0.0002487562189054727], [0.005115089514066497, 0.0008951406649616368], [0.02099737532808399, 0.005905511811023622], [0.02702702702702703, 0.007432432432432433], [0.03888888888888889, 0.010277777777777778], [0.04285714285714286, 0.011571428571428571], [0.04398826979472141, 0.013489736070381233], [0.0572289156626506, 0.013855421686746987], [0.05263157894736842, 0.0173374613003096], [0.06369426751592357, 0.02101910828025478], [0.10130718954248366, 0.03300653594771242], [0.10101010101010101, 0.032828282828282825], [0.09310344827586207, 0.02620689655172414], [0.1595744680851064, 0.05035460992907799], [0.14233576642335766, 0.045255474452554754], [0.18726591760299627, 0.0591760299625468], [0.19615384615384615, 0.07038461538461539], [0.18181818181818182, 0.056916996047430835], [0.21862348178137653, 0.0708502024291498], [0.2125, 0.06750000000000002], [0.2905982905982906, 0.08653846153846152], [0.30701754385964913, 0.08750000000000001], [0.22972972972972974, 0.07162162162162163], [0.27314814814814814, 0.08865740740740742], [0.3127962085308057, 0.10260663507109005], [0.34146341463414637, 0.10829268292682927], [0.365, 0.12149999999999997], [0.37948717948717947, 0.11282051282051284], [0.3894736842105263, 0.153421052631579], [0.43243243243243246, 0.14135135135135132], [0.5248618784530387, 0.16215469613259667], [0.35795454545454547, 0.12130681818181817], [0.4476744186046512, 0.15639534883720932], [0.5357142857142857, 0.17380952380952377], [0.5, 0.16128048780487805], [0.4875, 0.1628125], [0.5448717948717948, 0.16634615384615384], [0.5657894736842105, 0.18815789473684208], [0.6554054054054054, 0.21655405405405403], [0.5379310344827586, 0.1817241379310345], [0.6382978723404256, 0.21489361702127652], [0.6304347826086957, 0.21268115942028984], [0.6074074074074074, 0.20370370370370366], [0.6439393939393939, 0.21249999999999997], [0.7209302325581395, 0.2414728682170542], [0.6111111111111112, 0.2023809523809524], [0.7073170731707317, 0.23699186991869908], [0.7166666666666667, 0.23291666666666655], [0.7288135593220338, 0.23050847457627122], [0.7043478260869566, 0.23956521739130437], [0.6696428571428571, 0.21026785714285715], [0.7454545454545455, 0.2595454545454546], [0.7757009345794392, 0.2700934579439253], [0.8, 0.2690476190476191], [0.7087378640776699, 0.24951456310679618], [0.8217821782178217, 0.26683168316831685], [0.7777777777777778, 0.2702020202020202], [0.7835051546391752, 0.2804123711340205], [0.6947368421052632, 0.2363157894736842], [0.7956989247311828, 0.3043010752688171], [0.7912087912087912, 0.28681318681318685], [0.8089887640449438, 0.28146067415730336], [0.7931034482758621, 0.28965517241379307], [0.8470588235294118, 0.3058823529411765], [0.8571428571428571, 0.29464285714285704], [0.8170731707317073, 0.28963414634146345], [0.8024691358024691, 0.28827160493827164], [0.8607594936708861, 0.2974683544303797], [0.8846153846153846, 0.31025641025641015], [0.8552631578947368, 0.28421052631578947], [0.88, 0.31333333333333335], [0.8493150684931506, 0.2664383561643835], [0.8333333333333334, 0.3152777777777779], [0.8732394366197183, 0.3007042253521127], [0.9285714285714286, 0.32214285714285723], [0.8529411764705882, 0.3441176470588236], [0.8805970149253731, 0.3253731343283583], [0.8636363636363636, 0.3416666666666667], [0.8923076923076924, 0.3392307692307692], [0.9375, 0.31953125000000004], [0.9047619047619048, 0.3484126984126984], [0.8548387096774194, 0.30806451612903235], [0.9016393442622951, 0.3836065573770492], [0.8666666666666667, 0.3433333333333333], [0.8983050847457628, 0.35169491525423713], [0.9482758620689655, 0.35775862068965514], [0.9298245614035088, 0.35438596491228064], [0.9285714285714286, 0.3267857142857142], [0.9821428571428571, 0.3544642857142857], [0.8909090909090909, 0.3381818181818182], [0.9259259259259259, 0.34814814814814815], [0.8867924528301887, 0.369811320754717], [0.9622641509433962, 0.3556603773584906], [0.8653846153846154, 0.36346153846153845]]]
print(data)

p_ber_y = []

p_fer_y = []
#print("len(data)=",len(data))
#print("len(data[0])=", len(data[0]))

for k in range(len(data)):
    for p in range(len(data[0])):
        p_ber_y.append(data[k][p][1])
        p_fer_y.append(data[k][p][0])

plt.plot(range_p, p_ber_y,"r+") #range_p_exp
#plt.plot(range(len(data[0])), p_fer_y,"b")

range_p_log = [np.log(y) for y in range_p] #range_p_exp
lr = scipy.stats.linregress(range_p_log,p_ber_y)

print("correlation=",lr[2])
y = []
for x in range_p_log:
    y.append(x*lr[0] + lr[1])


plt.plot(range_p,y,"b") #range_p_exp

plt.yscale("log")
plt.show()




